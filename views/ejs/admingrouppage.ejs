<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">
    <link rel="stylesheet" href="../public/css/grouppage.css">
    <link rel="stylesheet" href="../public/css/navigation.css">

    <title> Group Page</title>
</head>
<body>

<!--de adaugat si un previously read-->
<!--de adaugat linkuri-->
<!--optional: sa-ti marchezi progresul direct de aici-->
<!--sa poti sa dai minimize la chestile astea albe-->
<!--de aia sa poti sa lasi comentarii ca acuma doar le vezi-->
<!--sa poti sa iesi din grup-->
<!--si tb sa fac si gen varianta pt seful grupului de la pagaina asta-->

<div id="wrapper-div">
    <div id="navigation-div">
        <nav>
            <div id="toggle-menu">

                <a href="#" class="toggle-button">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </a>
                <div id="dropdown-menu">
                    <div class="menu-buttons">
                        <a class="active"  href="javascript:void(0);" onclick="navigateToAdminPage('homepage')">Posts</a>
                        <a class="active"  href="javascript:void(0);" onclick="navigateToAdminPage('users')">Users</a>
                        <a class="active"  href="javascript:void(0);" onclick="navigateToAdminPage('adminaddbookpage')">Add book</a>

                        <div class="hoverable">

                            <a class="active" href="#">Categories</a>
                            <div class="hamburger-double-dropdown">
                                <a href="javascript:void(0);" onclick="navigateToGenreAdmin('romance')">Romance</a>
                                <a href="javascript:void(0);" onclick="navigateToGenreAdmin('biography')">Biography</a>
                                <a href="javascript:void(0);" onclick="navigateToGenreAdmin('crime')">Crime</a>
                                <a  href="javascript:void(0);"onclick="navigateToGenreAdmin('fiction')">Fiction</a>
                                <a  href="javascript:void(0);" onclick="navigateToGenreAdmin('historical fiction')">Historical Fiction</a>
                                <a href="javascript:void(0);" onclick="navigateToGenreAdmin('self help')">Self Help</a>
                                <a href="javascript:void(0);" onclick="navigateToGenreAdmin('young adult')">Young Adult</a>
                            </div>
                        </div>
                        <a class="active" href="javascript:void(0);" onclick="navigateToAllGroups()">Groups</a>
                        <div class="hoverable">

                            <a class="active" href="#">More</a>
                            <div class="hamburger-double-dropdown">
                                <a href="javascript:void(0);" onclick="navigateToAdminOwnUserProfile()">Profile</a>
                                <a href="javascript:void(0);" onclick="navigateToStatisticsAdmin()">Statistics</a>
                                <a href="javascript:void(0);" onclick="navigateToRss()">RSS</a>
                                <a href="javascript:void(0);" onclick="logout()">Log Out</a>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <div class="buttons">
                <a class="logo" href="javascript:void(0);" onclick="navigateToAdminPage('homepage')"><img src="boo.png"
                                                                                                          alt="Ghost reading a book"></a>
                <a class="active"  href="javascript:void(0);" onclick="navigateToAdminPage('homepage')">Posts</a>
                <a class="active"  href="javascript:void(0);" onclick="navigateToAdminPage('users')">Users</a>
                <a class="active"  href="javascript:void(0);" onclick="navigateToAdminPage('adminaddbookpage')">Add book</a>

                <div class="dropdown">
                    <button class="dropDownButton">Categories</button>
                    <div class="dropdown-categories">
                        <a href="javascript:void(0);" onclick="navigateToGenreAdmin('romance')">Romance</a>
                        <a href="javascript:void(0);" onclick="navigateToGenreAdmin('biography')">Biography</a>
                        <a href="javascript:void(0);" onclick="navigateToGenreAdmin('crime')">Crime</a>
                        <a  href="javascript:void(0);" onclick="navigateToGenreAdmin('fiction')">Fiction</a>
                        <a  href="javascript:void(0);" onclick="navigateToGenreAdmin('historical fiction')">Historical Fiction</a>
                        <a href="javascript:void(0);" onclick="navigateToGenreAdmin('self help')">Self Help</a>
                        <a href="javascript:void(0);" onclick="navigateToGenreAdmin('young adult')">Young Adult</a>
                    </div>
                </div>
                <a class="active" href="javascript:void(0);" onclick="navigateToAllGroups()">Groups</a>
                <div class="dropdown">
                    <button class="dropDownButton">More</button>
                    <div class="dropdown-categories">
                        <a href="javascript:void(0);" onclick="navigateToAdminOwnUserProfile()">Profile</a>
                        <a href="javascript:void(0);" onclick="navigateToStatisticsAdmin()">Statistics</a>
                        <a href="javascript:void(0);" onclick="navigateToRss()">RSS</a>
                        <a href="javascript:void(0);" onclick="logout()">Log Out</a>
                    </div>
                </div>

            </div>
            <div id="search-bar">
                <input type="text" id="search-input" placeholder="Search...">
            </div>
        </nav>
    </div>
    <div id="content-wrapper">
        <div id="buttons-container">
            <button class="button" id="deleteGroup">Delete Group</button>
        </div>
        <div id="content">
            <p class = "group-title">
                <%=group.name%>
                <% if (group.is_owner) { %>
                    (OWNER)
                <% } %>
            </p>
            <hr>
            <p class = "invite-code">
                invite code: <%=group.invite_code%>
            </p>

            <%if(group.book_id === null){%>
            <div class = "no-book-summary">
                <div class = "book-cover">
                    <img src="ghost.png" alt="cute ghost">

                </div>
                <div class = "book-information">
                    <%if(!group.is_owner){%> <h1>We aren't reading anything at the moment! Come back later!</h1>
                    <%}else {%>
                        <div class = add-book>
                            <h1>Choose a book for your group to read!</h1>
                            <input type="text" id="addBookInput" placeholder="Enter a book...">
                            <button type="button" id="addBookButton">Enter</button>
                        </div>
                    <%}%>
                </div>
            </div>
            <%}else{%>

            <p class="category-title">
                We are currently reading...
            </p>
            <div class="book">

                <div class = "book-summary">
                    <p class = "related-book-id" style = "display: none " ><%=group.book_id%></p>
                    <div class = "book-cover">
                        <a class = "navigate-to-book-admin">
                            <img src="<%= group.coverimg %>" alt="Book cover">
                        </a>
                    </div>

                    <div class = "book-information">

                        <div class = "title">
                            <a class = "navigate-to-book-admin">
                                <%=group.title%>
                            </a>
                        </div>
                        <a href="javascript:void(0);" onclick="navigateToAuthorAdmin('<%=group.author%>')" class="author">
                            <%=group.author%>
                        </a>

                        <div class="rating-box">
                            <div class="preset-rating">
                                <div class="empty-stars"></div>
                                <div class="full-stars" style="width: <%= group.rating * 20 %>%"></div>
                            </div>
                            <p>
                                <%=group.rating%>
                            </p>
                        </div>

                        <p class="description">
                            <%=group.description%>
                        </p>

                    </div>
                </div>
            </div>

            <%if(group.is_owner){%>
                <div class = "no-book-summary">
                    <div class = "book-cover">
                        <img src="ghost.png" alt="cute ghost">
                    </div>
                    <div class = "book-information">
                        <div class = add-book>
                            <h1>Choose another book for your group to read!</h1>
                            <input type="text" id="addBookInput" placeholder="Enter a book...">
                            <button type="button" id="addBookButton">Enter</button>
                        </div>
                    </div>
                </div>
            <%}%>

            <div class="members-wrapper">
                <h1>
                    Members' progress:
                </h1>
                <hr>

                <table class="styled-table">
                    <thead>
                    <tr>
                        <th>Username</th>
                        <th>Shelf</th>
                        <th>Rating</th>
                    </tr>
                    </thead>
                    <tbody>

                    <% members.forEach(function(member) { %>
                    <!--                        //tb sa fac request si de review aoleo-->
                    <tr
                    <%if(member.shelf === 'Read') {%>
                        class = "active-row"
                            <%}%>
                    >
                        <td> <%=member.username%> </td>
                        <td>
                            <%if(member.shelf !== null){%>
                            <%=member.shelf%>
                            <%}else{%>
                                -
                            <%}%>
                        </td>
                        <td>
                            <%if(member.stars!==null){%>
                                <div class="preset-rating">
                                    <div class="empty-stars"></div>
                                    <div class="full-stars" style="width: <%= member.stars * 20 %>%"></div>
                                </div>
                            <%}%>
                        </td>
                    </tr>
                    <%})%>
                    </tbody>
                </table>
            </div>

            <div id="feed-div">
                <h1>Discussion</h1>
                <hr>
                <% members.forEach(function(review) { %>
                <%if(review.stars!== null){%>
                <div class="post-container">
                    <!--aici putem pune poza userului-->
                    <div class="user-profile">
                        <p><%=review.username%></p>
                        <span><%= review.date %> </span>
                    </div>

                    <div class="rating-box">
                        <div class="preset-rating">
                            <div class="empty-stars"></div>
                            <div class="full-stars" style="width: <%= review.stars * 20 %>%"></div>
                        </div>
                    </div>

                    <div class="book">
                        <p class = "related-book-id" style = "display: none " ><%=group.book_id%></p>
                        <p class="post-text">"I Rated <a class="navigate-to-book-admin" class="book-title"><%= group.title %></a>
                            by <a
                                    href="javascript:void(0);" onclick="navigateToAuthorAdmin('<%= group.author %>')"
                                    class="book-author"><%= group.author %></a> <%= review.stars %>
                            stars!"
                        </p>
                    </div>
                    <% if (!review.isgeneric || review.isgeneric === null) { %>
                    <p class = post-text>
                        <%=review.content%>
                    </p>
                    <% } %>
                </div>
                <%}%>
                <%})}%>

                <p id = "groupId"> <%=group.id%></p>

            </div>
        </div>
    </div>
</div>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src = "../public/scripts/comments_and_likes.js"></script>
    <script src = "admingrouppage.js"></script>
    <script src ="navigationLinks.js"></script>
    <script src ="deletePost.js"></script>
    <script>
        navigateToSearchAdmin();
    </script>
</body>
</html>