<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">
    <link rel="stylesheet" href="../public/css/grouppage.css">
    <link rel="stylesheet" href="../public/css/navigation.css">

    <title> Group Page</title>
</head>
<body>

<!--de adaugat si un previously read-->
<!--de adaugat linkuri-->
<!--optional: sa-ti marchezi progresul direct de aici-->
<!--sa poti sa dai minimize la chestile astea albe-->
<!--de aia sa poti sa lasi comentarii ca acuma doar le vezi-->
<!--sa poti sa iesi din grup-->
<!--si tb sa fac si gen varianta pt seful grupului de la pagaina asta-->

<div id="wrapper-div">
    <div id="navigation-div">
        <nav>
            <div id="toggle-menu">

                <a href="#" class="toggle-button">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </a>
                <div id="dropdown-menu">
                    <div class="menu-buttons">
                        <a class="active"  href="javascript:void(0);" onclick="navigateToPage('homepage')">Home</a>
                        <a class="active"  href="javascript:void(0);" onclick="navigateToPage('mybooks')">My Books</a>
                        <div class="hoverable">

                            <a class="active" href="#">Categories</a>
                            <div class="hamburger-double-dropdown">
                                <a href="javascript:void(0);" onclick="navigateToGenre('romance')">Romance</a>
                                <a href="javascript:void(0);" onclick="navigateToGenre('biography')">Biography</a>
                                <a href="javascript:void(0);" onclick="navigateToGenre('crime')">Crime</a>
                                <a  href="javascript:void(0);"onclick="navigateToGenre('fiction')">Fiction</a>
                                <a  href="javascript:void(0);" onclick="navigateToGenre('historical fiction')">Historical Fiction</a>
                                <a href="javascript:void(0);" onclick="navigateToGenre('self help')">Self Help</a>
                                <a href="javascript:void(0);" onclick="navigateToGenre('young adult')">Young Adult</a>
                            </div>
                        </div>
                        <a class="active" href="javascript:void(0);" onclick="navigateToMyGroups()">My Groups</a>
                        <div class="hoverable">

                            <a class="active" href="#">More</a>
                            <div class="hamburger-double-dropdown">
                                <a href="javascript:void(0);" onclick="navigateToPage('userpage')">Profile</a>
                                <a href="javascript:void(0);" onclick="navigateToPage('about')">About</a>
                                <a href="javascript:void(0);" onclick="navigateToPage('help')">Help</a>
                                <a href="javascript:void(0);" onclick="logout()">Log Out</a>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <div class="buttons">
                <a class="logo" href="javascript:void(0);" onclick="navigateToPage('homepage')"><img src="boo.png"
                                                                                                     alt="Ghost reading a book"></a>
                <a class="active"  href="javascript:void(0);" onclick="navigateToPage('homepage')">Home</a>
                <a class="active"  href="javascript:void(0);" onclick="navigateToPage('mybooks')">My Books</a>
                <div class="dropdown">
                    <button class="dropDownButton">Categories</button>
                    <div class="dropdown-categories">
                        <a href="javascript:void(0);" onclick="navigateToGenre('romance')">Romance</a>
                        <a href="javascript:void(0);" onclick="navigateToGenre('biography')">Biography</a>
                        <a href="javascript:void(0);" onclick="navigateToGenre('crime')">Crime</a>
                        <a  href="javascript:void(0);"onclick="navigateToGenre('fiction')">Fiction</a>
                        <a  href="javascript:void(0);" onclick="navigateToGenre('historical fiction')">Historical Fiction</a>
                        <a href="javascript:void(0);" onclick="navigateToGenre('self help')">Self Help</a>
                        <a href="javascript:void(0);" onclick="navigateToGenre('young adult')">Young Adult</a>
                    </div>
                </div>
                <a class="active" href="javascript:void(0);" onclick="navigateToMyGroups()">My Groups</a>
                <div class="dropdown">
                    <button class="dropDownButton">More</button>
                    <div class="dropdown-categories">
                        <a href="javascript:void(0);" onclick="navigateToPage('userpage')">Profile</a>
                        <a href="javascript:void(0);" onclick="navigateToPage('about')">About</a>
                        <a href="javascript:void(0);" onclick="navigateToPage('help')">Help</a>
                        <a href="javascript:void(0);" onclick="logout()">Log Out</a>
                    </div>
                </div>

            </div>
            <div id="search-bar">
                <input type="text" placeholder="Search...">
            </div>
        </nav>
    </div>
    <div id="content-wrapper">
        <div id="content">
                <p class = "group-title">
                    <%=group.name%>
                    <% if (group.is_owner) { %>
                        (OWNER)
                    <% } %>
                </p>
                <hr>
                <p class = "invite-code">
                    invite code: <%=group.invite_code%>
                </p>

            <%if(group.book_id === null){%>
                <div class = "no-book-summary">
                    <div class = "book-cover">
                        <img src="ghost.png" alt="cute ghost">

                    </div>
                    <div class = "book-information">
                        <%if(!group.is_owner){%> <h1>We aren't reading anything at the moment! Come back later!</h1>
                        <%}else {%>
                            <div class = add-book>
                                <h1>Choose a book for your group to read!</h1>
                                <input type="text" id="addBookInput" placeholder="Enter a book...">
                                <button type="button" id="addBookButton">Enter</button>
                            </div>
                        <%}%>
                    </div>
                </div>
            <%}else{%>

            <p class="category-title">
                    We are currently reading...
                </p>
                <div class = "book-summary">
                    <div class = "book-cover">
                        <a href = "javascript:void(0);" onclick="navigateToBook('<%=group.title%>')">
                            <img src="<%= group.coverimg %>" alt="Book cover">
                        </a>
                    </div>
                    <div class = "book-information">
                        <a class="title" href = "javascript:void(0);" onclick="navigateToBook('<%=group.title%>')">
                            <%=group.title%>
                        </a>
                        <a class="author" href ="#">
                            <%=group.author%>
                        </a>

                        <div class="rating-box">
                            <div class="preset-rating">
                                <div class="empty-stars"></div>
                                <div class="full-stars" style="width: <%= group.rating * 20 %>%"></div>
                            </div>
                            <p>
                                <%=group.rating%>
                            </p>
                        </div>

                        <p class="description">
                            <%=group.description%>
                        </p>

                    </div>
                </div>

            <%if(group.is_owner){%>
                <div class = "no-book-summary">
                    <div class = "book-cover">
                        <img src="ghost.png" alt="cute ghost">
                    </div>
                    <div class = "book-information">
                        <div class = add-book>
                            <h1>Choose another book for your group to read!</h1>
                            <input type="text" id="addBookInput" placeholder="Enter a book...">
                            <button type="button" id="addBookButton">Enter</button>
                        </div>
                    </div>
                </div>
            <%}%>

                <div class="members-wrapper">
                    <h1>
                        Members' progress:
                    </h1>
                    <hr>

                    <table class="styled-table">
                        <thead>
                        <tr>
                            <th>Username</th>
                            <th>Shelf</th>
                            <th>Rating</th>
                        </tr>
                        </thead>
                        <tbody>

                        <% members.forEach(function(member) { %>
<!--                        //tb sa fac request si de review aoleo-->
                            <tr
                                    <%if(member.shelf === 'Read') {%>
                                        class = "active-row"
                                    <%}%>
                            >
                                <td> <%=member.username%> </td>
                                <td>
                                    <%if(member.shelf !== null){%>
                                        <%=member.shelf%>
                                    <%}else{%>
                                        -
                                    <%}%>
                                </td>
                                <td>
                                    <%if(member.stars!==null){%>
                                    <div class="preset-rating">
                                            <div class="empty-stars"></div>
                                            <div class="full-stars" style="width: <%= member.stars * 20 %>%"></div>
                                    </div>
                                    <%}%>
                                </td>
                            </tr>
                        <%})%>
                        </tbody>
                    </table>
                </div>

                <div id="feed-div">
                    <h1>Discussion</h1>
                    <hr>
                    <% members.forEach(function(review) { %>
                        <%if(review.stars!== null){%>
                            <div class="post-container">
                                <!--aici putem pune poza userului-->
                                <div class="user-profile">
                                    <p><%=review.username%></p>
                                    <span><%=review.date%> </span>
                                </div>

                                <div class="rating-box">
                                    <div class="preset-rating">
                                        <div class="empty-stars"></div>
                                        <div class="full-stars" style="width: <%= review.stars * 20 %>%"></div>
                                    </div>
                                </div>

                                <p class="post-text">"I Rated <a href="javascript:void(0);" onclick="navigateToBook('<%= group.title %>')" class="book-title"><%=group.title%></a> by <a
                                            href="javascript:void(0);" onclick="navigateToBook('<%= group.author %>')" class="book-author"><%=group.author%></a> <%=review.stars%>
                                    stars!"
                                </p>
                                <% if (!review.isgeneric || review.isgeneric === null) { %>
                                <p class = post-text>
                                    <%=review.content%>
                                </p>
                                <% } %>
                            </div>
                        <%}%>
                <%})}%>

            <p id = "groupId"> <%=group.id%></p>

        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src = "../public/scripts/comments_and_likes.js"></script>
<script src = "grouppage.js"></script>
<script src ="navigationLinks.js"></script>
</body>
</html>