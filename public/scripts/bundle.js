(()=>{var t={557:function(t){(function(){t.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(this)},335:function(t){(function(){t.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(this)},369:function(t){(function(){var e,n,r,i,s,o,h,a={}.hasOwnProperty;e=function(t,...e){var n,r,i,o;if(s(Object.assign))Object.assign.apply(null,arguments);else for(n=0,i=e.length;n<i;n++)if(null!=(o=e[n]))for(r in o)a.call(o,r)&&(t[r]=o[r]);return t},s=function(t){return!!t&&"[object Function]"===Object.prototype.toString.call(t)},o=function(t){var e;return!!t&&("function"==(e=typeof t)||"object"===e)},r=function(t){return s(Array.isArray)?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)},i=function(t){var e;if(r(t))return!t.length;for(e in t)if(a.call(t,e))return!1;return!0},h=function(t){var e,n;return o(t)&&(n=Object.getPrototypeOf(t))&&(e=n.constructor)&&"function"==typeof e&&e instanceof e&&Function.prototype.toString.call(e)===Function.prototype.toString.call(Object)},n=function(t){return s(t.valueOf)?t.valueOf():t},t.exports.assign=e,t.exports.isFunction=s,t.exports.isObject=o,t.exports.isArray=r,t.exports.isEmpty=i,t.exports.isPlainObject=h,t.exports.getValue=n}).call(this)},594:function(t){(function(){t.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(this)},750:function(t,e,n){(function(){var e;e=n(335),n(26),t.exports=function(){class t{constructor(t,n,r){if(this.parent=t,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),null==n)throw new Error("Missing attribute name. "+this.debugInfo(n));this.name=this.stringify.name(n),this.value=this.stringify.attValue(r),this.type=e.Attribute,this.isId=!1,this.schemaTypeInfo=null}clone(){return Object.create(this)}toString(t){return this.options.writer.attribute(this,this.options.writer.filterOptions(t))}debugInfo(t){return null==(t=t||this.name)?"parent: <"+this.parent.name+">":"attribute: {"+t+"}, parent: <"+this.parent.name+">"}isEqualNode(t){return t.namespaceURI===this.namespaceURI&&t.prefix===this.prefix&&t.localName===this.localName&&t.value===this.value}}return Object.defineProperty(t.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(t.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(t.prototype,"textContent",{get:function(){return this.value},set:function(t){return this.value=t||""}}),Object.defineProperty(t.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(t.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(t.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"specified",{get:function(){return!0}}),t}.call(this)}).call(this)},170:function(t,e,n){(function(){var e,r;e=n(335),r=n(488),t.exports=class extends r{constructor(t,n){if(super(t),null==n)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=e.CData,this.value=this.stringify.cdata(n)}clone(){return Object.create(this)}toString(t){return this.options.writer.cdata(this,this.options.writer.filterOptions(t))}}}).call(this)},488:function(t,e,n){(function(){var e;e=n(26),t.exports=function(){class t extends e{constructor(t){super(t),this.value=""}clone(){return Object.create(this)}substringData(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}appendData(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}insertData(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}deleteData(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}replaceData(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}isEqualNode(t){return!!super.isEqualNode(t)&&t.data===this.data}}return Object.defineProperty(t.prototype,"data",{get:function(){return this.value},set:function(t){return this.value=t||""}}),Object.defineProperty(t.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(t.prototype,"textContent",{get:function(){return this.value},set:function(t){return this.value=t||""}}),t}.call(this)}).call(this)},96:function(t,e,n){(function(){var e,r;e=n(335),r=n(488),t.exports=class extends r{constructor(t,n){if(super(t),null==n)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=e.Comment,this.value=this.stringify.comment(n)}clone(){return Object.create(this)}toString(t){return this.options.writer.comment(this,this.options.writer.filterOptions(t))}}}).call(this)},383:function(t,e,n){(function(){var e,r;e=n(933),r=n(210),t.exports=function(){class t{constructor(){this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new e,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=Object.create(this.defaultParams)}getParameter(t){return this.params.hasOwnProperty(t)?this.params[t]:null}canSetParameter(t,e){return!0}setParameter(t,e){return null!=e?this.params[t]=e:delete this.params[t]}}return Object.defineProperty(t.prototype,"parameterNames",{get:function(){return new r(Object.keys(this.defaultParams))}}),t}.call(this)}).call(this)},933:function(t){(function(){t.exports=class{constructor(){}handleError(t){throw new Error(t)}}}).call(this)},770:function(t){(function(){t.exports=class{hasFeature(t,e){return!0}createDocumentType(t,e,n){throw new Error("This DOM method is not implemented.")}createDocument(t,e,n){throw new Error("This DOM method is not implemented.")}createHTMLDocument(t){throw new Error("This DOM method is not implemented.")}getFeature(t,e){throw new Error("This DOM method is not implemented.")}}}).call(this)},210:function(t){(function(){t.exports=function(){class t{constructor(t){this.arr=t||[]}item(t){return this.arr[t]||null}contains(t){return-1!==this.arr.indexOf(t)}}return Object.defineProperty(t.prototype,"length",{get:function(){return this.arr.length}}),t}.call(this)}).call(this)},179:function(t,e,n){(function(){var e,r;r=n(26),e=n(335),t.exports=class extends r{constructor(t,n,r,i,s,o){if(super(t),null==n)throw new Error("Missing DTD element name. "+this.debugInfo());if(null==r)throw new Error("Missing DTD attribute name. "+this.debugInfo(n));if(!i)throw new Error("Missing DTD attribute type. "+this.debugInfo(n));if(!s)throw new Error("Missing DTD attribute default. "+this.debugInfo(n));if(0!==s.indexOf("#")&&(s="#"+s),!s.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(n));if(o&&!s.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(n));this.elementName=this.stringify.name(n),this.type=e.AttributeDeclaration,this.attributeName=this.stringify.name(r),this.attributeType=this.stringify.dtdAttType(i),o&&(this.defaultValue=this.stringify.dtdAttDefault(o)),this.defaultValueType=s}toString(t){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(t))}}}).call(this)},347:function(t,e,n){(function(){var e,r;r=n(26),e=n(335),t.exports=class extends r{constructor(t,n,r){if(super(t),null==n)throw new Error("Missing DTD element name. "+this.debugInfo());r||(r="(#PCDATA)"),Array.isArray(r)&&(r="("+r.join(",")+")"),this.name=this.stringify.name(n),this.type=e.ElementDeclaration,this.value=this.stringify.dtdElementValue(r)}toString(t){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(t))}}}).call(this)},78:function(t,e,n){(function(){var e,r,i;({isObject:i}=n(369)),r=n(26),e=n(335),t.exports=function(){class t extends r{constructor(t,n,r,s){if(super(t),null==r)throw new Error("Missing DTD entity name. "+this.debugInfo(r));if(null==s)throw new Error("Missing DTD entity value. "+this.debugInfo(r));if(this.pe=!!n,this.name=this.stringify.name(r),this.type=e.EntityDeclaration,i(s)){if(!s.pubID&&!s.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(r));if(s.pubID&&!s.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(r));if(this.internal=!1,null!=s.pubID&&(this.pubID=this.stringify.dtdPubID(s.pubID)),null!=s.sysID&&(this.sysID=this.stringify.dtdSysID(s.sysID)),null!=s.nData&&(this.nData=this.stringify.dtdNData(s.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(r))}else this.value=this.stringify.dtdEntityValue(s),this.internal=!0}toString(t){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(t))}}return Object.defineProperty(t.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(t.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(t.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(t.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(t.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(t.prototype,"xmlVersion",{get:function(){return null}}),t}.call(this)}).call(this)},777:function(t,e,n){(function(){var e,r;r=n(26),e=n(335),t.exports=function(){class t extends r{constructor(t,n,r){if(super(t),null==n)throw new Error("Missing DTD notation name. "+this.debugInfo(n));if(!r.pubID&&!r.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(n));this.name=this.stringify.name(n),this.type=e.NotationDeclaration,null!=r.pubID&&(this.pubID=this.stringify.dtdPubID(r.pubID)),null!=r.sysID&&(this.sysID=this.stringify.dtdSysID(r.sysID))}toString(t){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(t))}}return Object.defineProperty(t.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(t.prototype,"systemId",{get:function(){return this.sysID}}),t}.call(this)}).call(this)},77:function(t,e,n){(function(){var e,r,i;({isObject:i}=n(369)),r=n(26),e=n(335),t.exports=class extends r{constructor(t,n,r,s){super(t),i(n)&&({version:n,encoding:r,standalone:s}=n),n||(n="1.0"),this.type=e.Declaration,this.version=this.stringify.xmlVersion(n),null!=r&&(this.encoding=this.stringify.xmlEncoding(r)),null!=s&&(this.standalone=this.stringify.xmlStandalone(s))}toString(t){return this.options.writer.declaration(this,this.options.writer.filterOptions(t))}}}).call(this)},544:function(t,e,n){(function(){var e,r,i,s,o,h,a,l;({isObject:l}=n(369)),a=n(26),e=n(335),r=n(179),s=n(78),i=n(347),o=n(777),h=n(663),t.exports=function(){class t extends a{constructor(t,n,r){var i,s,o,h;if(super(t),this.type=e.DocType,t.children)for(s=0,o=(h=t.children).length;s<o;s++)if((i=h[s]).type===e.Element){this.name=i.name;break}this.documentObject=t,l(n)&&({pubID:n,sysID:r}=n),null==r&&([r,n]=[n,r]),null!=n&&(this.pubID=this.stringify.dtdPubID(n)),null!=r&&(this.sysID=this.stringify.dtdSysID(r))}element(t,e){var n;return n=new i(this,t,e),this.children.push(n),this}attList(t,e,n,i,s){var o;return o=new r(this,t,e,n,i,s),this.children.push(o),this}entity(t,e){var n;return n=new s(this,!1,t,e),this.children.push(n),this}pEntity(t,e){var n;return n=new s(this,!0,t,e),this.children.push(n),this}notation(t,e){var n;return n=new o(this,t,e),this.children.push(n),this}toString(t){return this.options.writer.docType(this,this.options.writer.filterOptions(t))}ele(t,e){return this.element(t,e)}att(t,e,n,r,i){return this.attList(t,e,n,r,i)}ent(t,e){return this.entity(t,e)}pent(t,e){return this.pEntity(t,e)}not(t,e){return this.notation(t,e)}up(){return this.root()||this.documentObject}isEqualNode(t){return!!super.isEqualNode(t)&&t.name===this.name&&t.publicId===this.publicId&&t.systemId===this.systemId}}return Object.defineProperty(t.prototype,"entities",{get:function(){var t,n,r,i,s;for(i={},n=0,r=(s=this.children).length;n<r;n++)(t=s[n]).type!==e.EntityDeclaration||t.pe||(i[t.name]=t);return new h(i)}}),Object.defineProperty(t.prototype,"notations",{get:function(){var t,n,r,i,s;for(i={},n=0,r=(s=this.children).length;n<r;n++)(t=s[n]).type===e.NotationDeclaration&&(i[t.name]=t);return new h(i)}}),Object.defineProperty(t.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(t.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(t.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),t}.call(this)}).call(this)},934:function(t,e,n){(function(){var e,r,i,s,o,h,a;({isPlainObject:a}=n(369)),i=n(770),r=n(383),s=n(26),e=n(335),h=n(549),o=n(434),t.exports=function(){class t extends s{constructor(t){super(null),this.name="#document",this.type=e.Document,this.documentURI=null,this.domConfig=new r,t||(t={}),t.writer||(t.writer=new o),this.options=t,this.stringify=new h(t)}end(t){var e;return e={},t?a(t)&&(e=t,t=this.options.writer):t=this.options.writer,t.document(this,t.filterOptions(e))}toString(t){return this.options.writer.document(this,this.options.writer.filterOptions(t))}createElement(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}createDocumentFragment(){throw new Error("This DOM method is not implemented."+this.debugInfo())}createTextNode(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}createComment(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}createCDATASection(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}createProcessingInstruction(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}createAttribute(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}createEntityReference(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagName(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}importNode(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}createElementNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}createAttributeNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagNameNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementById(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}adoptNode(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}normalizeDocument(){throw new Error("This DOM method is not implemented."+this.debugInfo())}renameNode(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByClassName(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}createEvent(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}createRange(){throw new Error("This DOM method is not implemented."+this.debugInfo())}createNodeIterator(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}createTreeWalker(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}}return Object.defineProperty(t.prototype,"implementation",{value:new i}),Object.defineProperty(t.prototype,"doctype",{get:function(){var t,n,r,i;for(n=0,r=(i=this.children).length;n<r;n++)if((t=i[n]).type===e.DocType)return t;return null}}),Object.defineProperty(t.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(t.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(t.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(t.prototype,"xmlEncoding",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration?this.children[0].encoding:null}}),Object.defineProperty(t.prototype,"xmlStandalone",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration&&"yes"===this.children[0].standalone}}),Object.defineProperty(t.prototype,"xmlVersion",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(t.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(t.prototype,"origin",{get:function(){return null}}),Object.defineProperty(t.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(t.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(t.prototype,"contentType",{get:function(){return null}}),t}.call(this)}).call(this)},227:function(t,e,n){(function(){var e,r,i,s,o,h,a,l,u,c,d,p,m,f,g,y,w,b,D,v,O,I,E={}.hasOwnProperty;({isObject:O,isFunction:v,isPlainObject:I,getValue:D}=n(369)),e=n(335),p=n(934),m=n(161),s=n(170),o=n(96),g=n(406),b=n(595),f=n(181),c=n(77),d=n(544),h=n(179),l=n(78),a=n(347),u=n(777),i=n(750),w=n(549),y=n(434),r=n(594),t.exports=class{constructor(t,n,r){var i;this.name="?xml",this.type=e.Document,t||(t={}),i={},t.writer?I(t.writer)&&(i=t.writer,t.writer=new y):t.writer=new y,this.options=t,this.writer=t.writer,this.writerOptions=this.writer.filterOptions(i),this.stringify=new w(t),this.onDataCallback=n||function(){},this.onEndCallback=r||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}createChildNode(t){var n,r,i,s,o,h,a,l;switch(t.type){case e.CData:this.cdata(t.value);break;case e.Comment:this.comment(t.value);break;case e.Element:for(r in i={},a=t.attribs)E.call(a,r)&&(n=a[r],i[r]=n.value);this.node(t.name,i);break;case e.Dummy:this.dummy();break;case e.Raw:this.raw(t.value);break;case e.Text:this.text(t.value);break;case e.ProcessingInstruction:this.instruction(t.target,t.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+t.constructor.name)}for(o=0,h=(l=t.children).length;o<h;o++)s=l[o],this.createChildNode(s),s.type===e.Element&&this.up();return this}dummy(){return this}node(t,e,n){if(null==t)throw new Error("Missing node name.");if(this.root&&-1===this.currentLevel)throw new Error("Document can only have one root node. "+this.debugInfo(t));return this.openCurrent(),t=D(t),null==e&&(e={}),e=D(e),O(e)||([n,e]=[e,n]),this.currentNode=new m(this,t,e),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,null!=n&&this.text(n),this}element(t,n,r){var i,s,o,h,a,l;if(this.currentNode&&this.currentNode.type===e.DocType)this.dtdElement(...arguments);else if(Array.isArray(t)||O(t)||v(t))for(h=this.options.noValidation,this.options.noValidation=!0,(l=new p(this.options).element("TEMP_ROOT")).element(t),this.options.noValidation=h,s=0,o=(a=l.children).length;s<o;s++)i=a[s],this.createChildNode(i),i.type===e.Element&&this.up();else this.node(t,n,r);return this}attribute(t,e){var n,r;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(t));if(null!=t&&(t=D(t)),O(t))for(n in t)E.call(t,n)&&(r=t[n],this.attribute(n,r));else v(e)&&(e=e.apply()),this.options.keepNullAttributes&&null==e?this.currentNode.attribs[t]=new i(this,t,""):null!=e&&(this.currentNode.attribs[t]=new i(this,t,e));return this}text(t){var e;return this.openCurrent(),e=new b(this,t),this.onData(this.writer.text(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}cdata(t){var e;return this.openCurrent(),e=new s(this,t),this.onData(this.writer.cdata(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}comment(t){var e;return this.openCurrent(),e=new o(this,t),this.onData(this.writer.comment(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}raw(t){var e;return this.openCurrent(),e=new g(this,t),this.onData(this.writer.raw(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}instruction(t,e){var n,r,i,s,o;if(this.openCurrent(),null!=t&&(t=D(t)),null!=e&&(e=D(e)),Array.isArray(t))for(n=0,s=t.length;n<s;n++)r=t[n],this.instruction(r);else if(O(t))for(r in t)E.call(t,r)&&(i=t[r],this.instruction(r,i));else v(e)&&(e=e.apply()),o=new f(this,t,e),this.onData(this.writer.processingInstruction(o,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this}declaration(t,e,n){var r;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return r=new c(this,t,e,n),this.onData(this.writer.declaration(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}doctype(t,e,n){if(this.openCurrent(),null==t)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new d(this,e,n),this.currentNode.rootNodeName=t,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this}dtdElement(t,e){var n;return this.openCurrent(),n=new a(this,t,e),this.onData(this.writer.dtdElement(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}attList(t,e,n,r,i){var s;return this.openCurrent(),s=new h(this,t,e,n,r,i),this.onData(this.writer.dtdAttList(s,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}entity(t,e){var n;return this.openCurrent(),n=new l(this,!1,t,e),this.onData(this.writer.dtdEntity(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}pEntity(t,e){var n;return this.openCurrent(),n=new l(this,!0,t,e),this.onData(this.writer.dtdEntity(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}notation(t,e){var n;return this.openCurrent(),n=new u(this,t,e),this.onData(this.writer.dtdNotation(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}up(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this}end(){for(;this.currentLevel>=0;)this.up();return this.onEnd()}openCurrent(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)}openNode(t){var n,i,s,o;if(!t.isOpen){if(this.root||0!==this.currentLevel||t.type!==e.Element||(this.root=t),i="",t.type===e.Element){for(s in this.writerOptions.state=r.OpenTag,i=this.writer.indent(t,this.writerOptions,this.currentLevel)+"<"+t.name,o=t.attribs)E.call(o,s)&&(n=o[s],i+=this.writer.attribute(n,this.writerOptions,this.currentLevel));i+=(t.children?">":"/>")+this.writer.endline(t,this.writerOptions,this.currentLevel),this.writerOptions.state=r.InsideTag}else this.writerOptions.state=r.OpenTag,i=this.writer.indent(t,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+t.rootNodeName,t.pubID&&t.sysID?i+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(i+=' SYSTEM "'+t.sysID+'"'),t.children?(i+=" [",this.writerOptions.state=r.InsideTag):(this.writerOptions.state=r.CloseTag,i+=">"),i+=this.writer.endline(t,this.writerOptions,this.currentLevel);return this.onData(i,this.currentLevel),t.isOpen=!0}}closeNode(t){var n;if(!t.isClosed)return"",this.writerOptions.state=r.CloseTag,n=t.type===e.Element?this.writer.indent(t,this.writerOptions,this.currentLevel)+"</"+t.name+">"+this.writer.endline(t,this.writerOptions,this.currentLevel):this.writer.indent(t,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(t,this.writerOptions,this.currentLevel),this.writerOptions.state=r.None,this.onData(n,this.currentLevel),t.isClosed=!0}onData(t,e){return this.documentStarted=!0,this.onDataCallback(t,e+1)}onEnd(){return this.documentCompleted=!0,this.onEndCallback()}debugInfo(t){return null==t?"":"node: <"+t+">"}ele(){return this.element(...arguments)}nod(t,e,n){return this.node(t,e,n)}txt(t){return this.text(t)}dat(t){return this.cdata(t)}com(t){return this.comment(t)}ins(t,e){return this.instruction(t,e)}dec(t,e,n){return this.declaration(t,e,n)}dtd(t,e,n){return this.doctype(t,e,n)}e(t,e,n){return this.element(t,e,n)}n(t,e,n){return this.node(t,e,n)}t(t){return this.text(t)}d(t){return this.cdata(t)}c(t){return this.comment(t)}r(t){return this.raw(t)}i(t,e){return this.instruction(t,e)}att(){return this.currentNode&&this.currentNode.type===e.DocType?this.attList(...arguments):this.attribute(...arguments)}a(){return this.currentNode&&this.currentNode.type===e.DocType?this.attList(...arguments):this.attribute(...arguments)}ent(t,e){return this.entity(t,e)}pent(t,e){return this.pEntity(t,e)}not(t,e){return this.notation(t,e)}}}).call(this)},833:function(t,e,n){(function(){var e,r;r=n(26),e=n(335),t.exports=class extends r{constructor(t){super(t),this.type=e.Dummy}clone(){return Object.create(this)}toString(t){return""}}}).call(this)},161:function(t,e,n){(function(){var e,r,i,s,o,h,a,l={}.hasOwnProperty;({isObject:a,isFunction:h,getValue:o}=n(369)),s=n(26),e=n(335),r=n(750),i=n(663),t.exports=function(){class t extends s{constructor(t,n,r){var i,s,o,h;if(super(t),null==n)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(n),this.type=e.Element,this.attribs={},this.schemaTypeInfo=null,null!=r&&this.attribute(r),t.type===e.Document&&(this.isRoot=!0,this.documentObject=t,t.rootObject=this,t.children))for(s=0,o=(h=t.children).length;s<o;s++)if((i=h[s]).type===e.DocType){i.name=this.name;break}}clone(){var t,e,n,r;for(e in(n=Object.create(this)).isRoot&&(n.documentObject=null),n.attribs={},r=this.attribs)l.call(r,e)&&(t=r[e],n.attribs[e]=t.clone());return n.children=[],this.children.forEach((function(t){var e;return(e=t.clone()).parent=n,n.children.push(e)})),n}attribute(t,e){var n,i;if(null!=t&&(t=o(t)),a(t))for(n in t)l.call(t,n)&&(i=t[n],this.attribute(n,i));else h(e)&&(e=e.apply()),this.options.keepNullAttributes&&null==e?this.attribs[t]=new r(this,t,""):null!=e&&(this.attribs[t]=new r(this,t,e));return this}removeAttribute(t){var e,n,r;if(null==t)throw new Error("Missing attribute name. "+this.debugInfo());if(t=o(t),Array.isArray(t))for(n=0,r=t.length;n<r;n++)e=t[n],delete this.attribs[e];else delete this.attribs[t];return this}toString(t){return this.options.writer.element(this,this.options.writer.filterOptions(t))}att(t,e){return this.attribute(t,e)}a(t,e){return this.attribute(t,e)}getAttribute(t){return this.attribs.hasOwnProperty(t)?this.attribs[t].value:null}setAttribute(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}getAttributeNode(t){return this.attribs.hasOwnProperty(t)?this.attribs[t]:null}setAttributeNode(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}removeAttributeNode(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagName(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}getAttributeNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}setAttributeNS(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}removeAttributeNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}getAttributeNodeNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}setAttributeNodeNS(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagNameNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}hasAttribute(t){return this.attribs.hasOwnProperty(t)}hasAttributeNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}setIdAttribute(t,e){return this.attribs.hasOwnProperty(t)?this.attribs[t].isId:e}setIdAttributeNS(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}setIdAttributeNode(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagName(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagNameNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByClassName(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}isEqualNode(t){var e,n,r;if(!super.isEqualNode(t))return!1;if(t.namespaceURI!==this.namespaceURI)return!1;if(t.prefix!==this.prefix)return!1;if(t.localName!==this.localName)return!1;if(t.attribs.length!==this.attribs.length)return!1;for(e=n=0,r=this.attribs.length-1;0<=r?n<=r:n>=r;e=0<=r?++n:--n)if(!this.attribs[e].isEqualNode(t.attribs[e]))return!1;return!0}}return Object.defineProperty(t.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(t.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(t.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(t.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(t.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(t.prototype,"attributes",{get:function(){return this.attributeMap&&this.attributeMap.nodes||(this.attributeMap=new i(this.attribs)),this.attributeMap}}),t}.call(this)}).call(this)},663:function(t){(function(){t.exports=function(){class t{constructor(t){this.nodes=t}clone(){return this.nodes=null}getNamedItem(t){return this.nodes[t]}setNamedItem(t){var e;return e=this.nodes[t.nodeName],this.nodes[t.nodeName]=t,e||null}removeNamedItem(t){var e;return e=this.nodes[t],delete this.nodes[t],e||null}item(t){return this.nodes[Object.keys(this.nodes)[t]]||null}getNamedItemNS(t,e){throw new Error("This DOM method is not implemented.")}setNamedItemNS(t){throw new Error("This DOM method is not implemented.")}removeNamedItemNS(t,e){throw new Error("This DOM method is not implemented.")}}return Object.defineProperty(t.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),t}.call(this)}).call(this)},26:function(t,e,n){(function(){var e,r,i,s,o,h,a,l,u,c,d,p,m,f,g,y,w={}.hasOwnProperty,b=[].splice;({isObject:y,isFunction:g,isEmpty:f,getValue:m}=n(369)),l=null,i=null,s=null,o=null,h=null,d=null,p=null,c=null,a=null,r=null,u=null,e=null,t.exports=function(){class t{constructor(t){this.parent=t,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,l||(l=n(161),i=n(170),s=n(96),o=n(77),h=n(544),d=n(406),p=n(595),c=n(181),a=n(833),r=n(335),u=n(390),n(663),e=n(557))}setParent(t){var e,n,r,i,s;for(this.parent=t,t&&(this.options=t.options,this.stringify=t.stringify),s=[],n=0,r=(i=this.children).length;n<r;n++)e=i[n],s.push(e.setParent(this));return s}element(t,e,n){var r,i,s,o,h,a,l,u,c;if(a=null,null===e&&null==n&&([e,n]=[{},null]),null==e&&(e={}),e=m(e),y(e)||([n,e]=[e,n]),null!=t&&(t=m(t)),Array.isArray(t))for(s=0,l=t.length;s<l;s++)i=t[s],a=this.element(i);else if(g(t))a=this.element(t.apply());else if(y(t)){for(h in t)if(w.call(t,h))if(c=t[h],g(c)&&(c=c.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&0===h.indexOf(this.stringify.convertAttKey))a=this.attribute(h.substr(this.stringify.convertAttKey.length),c);else if(!this.options.separateArrayItems&&Array.isArray(c)&&f(c))a=this.dummy();else if(y(c)&&f(c))a=this.element(h);else if(this.options.keepNullNodes||null!=c)if(!this.options.separateArrayItems&&Array.isArray(c))for(o=0,u=c.length;o<u;o++)i=c[o],(r={})[h]=i,a=this.element(r);else y(c)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===h.indexOf(this.stringify.convertTextKey)?a=this.element(c):(a=this.element(h)).element(c):a=this.element(h,c);else a=this.dummy()}else a=this.options.keepNullNodes||null!==n?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===t.indexOf(this.stringify.convertTextKey)?this.text(n):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&0===t.indexOf(this.stringify.convertCDataKey)?this.cdata(n):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&0===t.indexOf(this.stringify.convertCommentKey)?this.comment(n):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&0===t.indexOf(this.stringify.convertRawKey)?this.raw(n):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&0===t.indexOf(this.stringify.convertPIKey)?this.instruction(t.substr(this.stringify.convertPIKey.length),n):this.node(t,e,n):this.dummy();if(null==a)throw new Error("Could not create any elements with: "+t+". "+this.debugInfo());return a}insertBefore(t,e,n){var r,i,s,o,h;if(null!=t?t.type:void 0)return o=e,(s=t).setParent(this),o?(i=children.indexOf(o),h=children.splice(i),children.push(s),Array.prototype.push.apply(children,h)):children.push(s),s;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(t));return i=this.parent.children.indexOf(this),h=this.parent.children.splice(i),r=this.parent.element(t,e,n),Array.prototype.push.apply(this.parent.children,h),r}insertAfter(t,e,n){var r,i,s;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(t));return i=this.parent.children.indexOf(this),s=this.parent.children.splice(i+1),r=this.parent.element(t,e,n),Array.prototype.push.apply(this.parent.children,s),r}remove(){var t;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return t=this.parent.children.indexOf(this),b.apply(this.parent.children,[t,t-t+1].concat([])),this.parent}node(t,e,n){var r;return null!=t&&(t=m(t)),e||(e={}),e=m(e),y(e)||([n,e]=[e,n]),r=new l(this,t,e),null!=n&&r.text(n),this.children.push(r),r}text(t){var e;return y(t)&&this.element(t),e=new p(this,t),this.children.push(e),this}cdata(t){var e;return e=new i(this,t),this.children.push(e),this}comment(t){var e;return e=new s(this,t),this.children.push(e),this}commentBefore(t){var e,n;return e=this.parent.children.indexOf(this),n=this.parent.children.splice(e),this.parent.comment(t),Array.prototype.push.apply(this.parent.children,n),this}commentAfter(t){var e,n;return e=this.parent.children.indexOf(this),n=this.parent.children.splice(e+1),this.parent.comment(t),Array.prototype.push.apply(this.parent.children,n),this}raw(t){var e;return e=new d(this,t),this.children.push(e),this}dummy(){return new a(this)}instruction(t,e){var n,r,i,s,o;if(null!=t&&(t=m(t)),null!=e&&(e=m(e)),Array.isArray(t))for(s=0,o=t.length;s<o;s++)n=t[s],this.instruction(n);else if(y(t))for(n in t)w.call(t,n)&&(r=t[n],this.instruction(n,r));else g(e)&&(e=e.apply()),i=new c(this,t,e),this.children.push(i);return this}instructionBefore(t,e){var n,r;return n=this.parent.children.indexOf(this),r=this.parent.children.splice(n),this.parent.instruction(t,e),Array.prototype.push.apply(this.parent.children,r),this}instructionAfter(t,e){var n,r;return n=this.parent.children.indexOf(this),r=this.parent.children.splice(n+1),this.parent.instruction(t,e),Array.prototype.push.apply(this.parent.children,r),this}declaration(t,e,n){var i,s;return i=this.document(),s=new o(i,t,e,n),0===i.children.length?i.children.unshift(s):i.children[0].type===r.Declaration?i.children[0]=s:i.children.unshift(s),i.root()||i}dtd(t,e){var n,i,s,o,a,l,u,c,d;for(n=this.document(),i=new h(n,t,e),s=o=0,l=(c=n.children).length;o<l;s=++o)if(c[s].type===r.DocType)return n.children[s]=i,i;for(s=a=0,u=(d=n.children).length;a<u;s=++a)if(d[s].isRoot)return n.children.splice(s,0,i),i;return n.children.push(i),i}up(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent}root(){var t;for(t=this;t;){if(t.type===r.Document)return t.rootObject;if(t.isRoot)return t;t=t.parent}}document(){var t;for(t=this;t;){if(t.type===r.Document)return t;t=t.parent}}end(t){return this.document().end(t)}prev(){var t;if((t=this.parent.children.indexOf(this))<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[t-1]}next(){var t;if(-1===(t=this.parent.children.indexOf(this))||t===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[t+1]}importDocument(t){var e,n,i,s,o;if((n=t.root().clone()).parent=this,n.isRoot=!1,this.children.push(n),this.type===r.Document&&(n.isRoot=!0,n.documentObject=this,this.rootObject=n,this.children))for(i=0,s=(o=this.children).length;i<s;i++)if((e=o[i]).type===r.DocType){e.name=n.name;break}return this}debugInfo(t){var e,n;return null!=(t=t||this.name)||(null!=(e=this.parent)?e.name:void 0)?null==t?"parent: <"+this.parent.name+">":(null!=(n=this.parent)?n.name:void 0)?"node: <"+t+">, parent: <"+this.parent.name+">":"node: <"+t+">":""}ele(t,e,n){return this.element(t,e,n)}nod(t,e,n){return this.node(t,e,n)}txt(t){return this.text(t)}dat(t){return this.cdata(t)}com(t){return this.comment(t)}ins(t,e){return this.instruction(t,e)}doc(){return this.document()}dec(t,e,n){return this.declaration(t,e,n)}e(t,e,n){return this.element(t,e,n)}n(t,e,n){return this.node(t,e,n)}t(t){return this.text(t)}d(t){return this.cdata(t)}c(t){return this.comment(t)}r(t){return this.raw(t)}i(t,e){return this.instruction(t,e)}u(){return this.up()}importXMLBuilder(t){return this.importDocument(t)}attribute(t,e){throw new Error("attribute() applies to element nodes only.")}att(t,e){return this.attribute(t,e)}a(t,e){return this.attribute(t,e)}removeAttribute(t){throw new Error("attribute() applies to element nodes only.")}replaceChild(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}removeChild(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}appendChild(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}hasChildNodes(){return 0!==this.children.length}cloneNode(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}normalize(){throw new Error("This DOM method is not implemented."+this.debugInfo())}isSupported(t,e){return!0}hasAttributes(){return 0!==this.attribs.length}compareDocumentPosition(t){var n,r;return(n=this)===t?0:this.document()!==t.document()?(r=e.Disconnected|e.ImplementationSpecific,Math.random()<.5?r|=e.Preceding:r|=e.Following,r):n.isAncestor(t)?e.Contains|e.Preceding:n.isDescendant(t)?e.Contains|e.Following:n.isPreceding(t)?e.Preceding:e.Following}isSameNode(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}lookupPrefix(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}isDefaultNamespace(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}lookupNamespaceURI(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}isEqualNode(t){var e,n,r;if(t.nodeType!==this.nodeType)return!1;if(t.children.length!==this.children.length)return!1;for(e=n=0,r=this.children.length-1;0<=r?n<=r:n>=r;e=0<=r?++n:--n)if(!this.children[e].isEqualNode(t.children[e]))return!1;return!0}getFeature(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}setUserData(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}getUserData(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}contains(t){return!!t&&(t===this||this.isDescendant(t))}isDescendant(t){var e,n,r,i;for(n=0,r=(i=this.children).length;n<r;n++){if(t===(e=i[n]))return!0;if(e.isDescendant(t))return!0}return!1}isAncestor(t){return t.isDescendant(this)}isPreceding(t){var e,n;return e=this.treePosition(t),n=this.treePosition(this),-1!==e&&-1!==n&&e<n}isFollowing(t){var e,n;return e=this.treePosition(t),n=this.treePosition(this),-1!==e&&-1!==n&&e>n}treePosition(t){var e,n;return n=0,e=!1,this.foreachTreeNode(this.document(),(function(r){if(n++,!e&&r===t)return e=!0})),e?n:-1}foreachTreeNode(t,e){var n,r,i,s,o;for(t||(t=this.document()),r=0,i=(s=t.children).length;r<i;r++){if(o=e(n=s[r]))return o;if(o=this.foreachTreeNode(n,e))return o}}}return Object.defineProperty(t.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(t.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(t.prototype,"childNodes",{get:function(){return this.childNodeList&&this.childNodeList.nodes||(this.childNodeList=new u(this.children)),this.childNodeList}}),Object.defineProperty(t.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(t.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(t.prototype,"previousSibling",{get:function(){var t;return t=this.parent.children.indexOf(this),this.parent.children[t-1]||null}}),Object.defineProperty(t.prototype,"nextSibling",{get:function(){var t;return t=this.parent.children.indexOf(this),this.parent.children[t+1]||null}}),Object.defineProperty(t.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(t.prototype,"textContent",{get:function(){var t,e,n,i,s;if(this.nodeType===r.Element||this.nodeType===r.DocumentFragment){for(s="",e=0,n=(i=this.children).length;e<n;e++)(t=i[e]).textContent&&(s+=t.textContent);return s}return null},set:function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),t}.call(this)}).call(this)},390:function(t){(function(){t.exports=function(){class t{constructor(t){this.nodes=t}clone(){return this.nodes=null}item(t){return this.nodes[t]||null}}return Object.defineProperty(t.prototype,"length",{get:function(){return this.nodes.length||0}}),t}.call(this)}).call(this)},181:function(t,e,n){(function(){var e,r;e=n(335),r=n(488),t.exports=class extends r{constructor(t,n,r){if(super(t),null==n)throw new Error("Missing instruction target. "+this.debugInfo());this.type=e.ProcessingInstruction,this.target=this.stringify.insTarget(n),this.name=this.target,r&&(this.value=this.stringify.insValue(r))}clone(){return Object.create(this)}toString(t){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(t))}isEqualNode(t){return!!super.isEqualNode(t)&&t.target===this.target}}}).call(this)},406:function(t,e,n){(function(){var e,r;e=n(335),r=n(26),t.exports=class extends r{constructor(t,n){if(super(t),null==n)throw new Error("Missing raw text. "+this.debugInfo());this.type=e.Raw,this.value=this.stringify.raw(n)}clone(){return Object.create(this)}toString(t){return this.options.writer.raw(this,this.options.writer.filterOptions(t))}}}).call(this)},996:function(t,e,n){(function(){var e,r,i,s={}.hasOwnProperty;e=n(335),i=n(751),r=n(594),t.exports=class extends i{constructor(t,e){super(e),this.stream=t}endline(t,e,n){return t.isLastRootNode&&e.state===r.CloseTag?"":super.endline(t,e,n)}document(t,e){var n,r,i,s,o,h,a,l,u;for(r=i=0,o=(a=t.children).length;i<o;r=++i)(n=a[r]).isLastRootNode=r===t.children.length-1;for(e=this.filterOptions(e),u=[],s=0,h=(l=t.children).length;s<h;s++)n=l[s],u.push(this.writeChildNode(n,e,0));return u}cdata(t,e,n){return this.stream.write(super.cdata(t,e,n))}comment(t,e,n){return this.stream.write(super.comment(t,e,n))}declaration(t,e,n){return this.stream.write(super.declaration(t,e,n))}docType(t,e,n){var i,s,o,h;if(n||(n=0),this.openNode(t,e,n),e.state=r.OpenTag,this.stream.write(this.indent(t,e,n)),this.stream.write("<!DOCTYPE "+t.root().name),t.pubID&&t.sysID?this.stream.write(' PUBLIC "'+t.pubID+'" "'+t.sysID+'"'):t.sysID&&this.stream.write(' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(t,e,n)),e.state=r.InsideTag,s=0,o=(h=t.children).length;s<o;s++)i=h[s],this.writeChildNode(i,e,n+1);e.state=r.CloseTag,this.stream.write("]")}return e.state=r.CloseTag,this.stream.write(e.spaceBeforeSlash+">"),this.stream.write(this.endline(t,e,n)),e.state=r.None,this.closeNode(t,e,n)}element(t,n,i){var o,h,a,l,u,c,d,p,m,f,g,y,w,b;if(i||(i=0),this.openNode(t,n,i),n.state=r.OpenTag,m=this.indent(t,n,i)+"<"+t.name,n.pretty&&n.width>0)for(p in c=m.length,g=t.attribs)s.call(g,p)&&(o=g[p],c+(f=this.attribute(o,n,i)).length>n.width?(b=this.indent(t,n,i+1)+f,m+=this.endline(t,n,i)+b,c=b.length):(m+=b=" "+f,c+=b.length));else for(p in y=t.attribs)s.call(y,p)&&(o=y[p],m+=this.attribute(o,n,i));if(this.stream.write(m),l=0===(a=t.children.length)?null:t.children[0],0===a||t.children.every((function(t){return(t.type===e.Text||t.type===e.Raw||t.type===e.CData)&&""===t.value})))n.allowEmpty?(this.stream.write(">"),n.state=r.CloseTag,this.stream.write("</"+t.name+">")):(n.state=r.CloseTag,this.stream.write(n.spaceBeforeSlash+"/>"));else if(!n.pretty||1!==a||l.type!==e.Text&&l.type!==e.Raw&&l.type!==e.CData||null==l.value){for(this.stream.write(">"+this.endline(t,n,i)),n.state=r.InsideTag,u=0,d=(w=t.children).length;u<d;u++)h=w[u],this.writeChildNode(h,n,i+1);n.state=r.CloseTag,this.stream.write(this.indent(t,n,i)+"</"+t.name+">")}else this.stream.write(">"),n.state=r.InsideTag,n.suppressPrettyCount++,this.writeChildNode(l,n,i+1),n.suppressPrettyCount--,n.state=r.CloseTag,this.stream.write("</"+t.name+">");return this.stream.write(this.endline(t,n,i)),n.state=r.None,this.closeNode(t,n,i)}processingInstruction(t,e,n){return this.stream.write(super.processingInstruction(t,e,n))}raw(t,e,n){return this.stream.write(super.raw(t,e,n))}text(t,e,n){return this.stream.write(super.text(t,e,n))}dtdAttList(t,e,n){return this.stream.write(super.dtdAttList(t,e,n))}dtdElement(t,e,n){return this.stream.write(super.dtdElement(t,e,n))}dtdEntity(t,e,n){return this.stream.write(super.dtdEntity(t,e,n))}dtdNotation(t,e,n){return this.stream.write(super.dtdNotation(t,e,n))}}}).call(this)},434:function(t,e,n){(function(){var e;e=n(751),t.exports=class extends e{constructor(t){super(t)}document(t,e){var n,r,i,s,o;for(e=this.filterOptions(e),s="",r=0,i=(o=t.children).length;r<i;r++)n=o[r],s+=this.writeChildNode(n,e,0);return e.pretty&&s.slice(-e.newline.length)===e.newline&&(s=s.slice(0,-e.newline.length)),s}}}).call(this)},549:function(t){(function(){var e={}.hasOwnProperty;t.exports=function(){class t{constructor(t){var n,r,i;for(n in this.assertLegalChar=this.assertLegalChar.bind(this),this.assertLegalName=this.assertLegalName.bind(this),t||(t={}),this.options=t,this.options.version||(this.options.version="1.0"),r=t.stringify||{})e.call(r,n)&&(i=r[n],this[n]=i)}name(t){return this.options.noValidation?t:this.assertLegalName(""+t||"")}text(t){return this.options.noValidation?t:this.assertLegalChar(this.textEscape(""+t||""))}cdata(t){return this.options.noValidation?t:(t=(t=""+t||"").replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(t))}comment(t){if(this.options.noValidation)return t;if((t=""+t||"").match(/--/))throw new Error("Comment text cannot contain double-hypen: "+t);return this.assertLegalChar(t)}raw(t){return this.options.noValidation?t:""+t||""}attValue(t){return this.options.noValidation?t:this.assertLegalChar(this.attEscape(t=""+t||""))}insTarget(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")}insValue(t){if(this.options.noValidation)return t;if((t=""+t||"").match(/\?>/))throw new Error("Invalid processing instruction value: "+t);return this.assertLegalChar(t)}xmlVersion(t){if(this.options.noValidation)return t;if(!(t=""+t||"").match(/1\.[0-9]+/))throw new Error("Invalid version number: "+t);return t}xmlEncoding(t){if(this.options.noValidation)return t;if(!(t=""+t||"").match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+t);return this.assertLegalChar(t)}xmlStandalone(t){return this.options.noValidation?t:t?"yes":"no"}dtdPubID(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")}dtdSysID(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")}dtdElementValue(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")}dtdAttType(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")}dtdAttDefault(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")}dtdEntityValue(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")}dtdNData(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")}assertLegalChar(t){var e,n;if(this.options.noValidation)return t;if("1.0"===this.options.version){if(e=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/g,void 0!==this.options.invalidCharReplacement)t=t.replace(e,this.options.invalidCharReplacement);else if(n=t.match(e))throw new Error(`Invalid character in string: ${t} at index ${n.index}`)}else if("1.1"===this.options.version)if(e=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/g,void 0!==this.options.invalidCharReplacement)t=t.replace(e,this.options.invalidCharReplacement);else if(n=t.match(e))throw new Error(`Invalid character in string: ${t} at index ${n.index}`);return t}assertLegalName(t){var e;if(this.options.noValidation)return t;if(e=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!(t=this.assertLegalChar(t)).match(e))throw new Error(`Invalid character in name: ${t}`);return t}textEscape(t){var e;return this.options.noValidation?t:(e=this.options.noDoubleEncoding?/(?!&(lt|gt|amp|apos|quot);)&/g:/&/g,t.replace(e,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))}attEscape(t){var e;return this.options.noValidation?t:(e=this.options.noDoubleEncoding?/(?!&(lt|gt|amp|apos|quot);)&/g:/&/g,t.replace(e,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))}}return t.prototype.convertAttKey="@",t.prototype.convertPIKey="?",t.prototype.convertTextKey="#text",t.prototype.convertCDataKey="#cdata",t.prototype.convertCommentKey="#comment",t.prototype.convertRawKey="#raw",t}.call(this)}).call(this)},595:function(t,e,n){(function(){var e,r;e=n(335),r=n(488),t.exports=function(){class t extends r{constructor(t,n){if(super(t),null==n)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=e.Text,this.value=this.stringify.text(n)}clone(){return Object.create(this)}toString(t){return this.options.writer.text(this,this.options.writer.filterOptions(t))}splitText(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}replaceWholeText(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}}return Object.defineProperty(t.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(t.prototype,"wholeText",{get:function(){var t,e,n;for(n="",e=this.previousSibling;e;)n=e.data+n,e=e.previousSibling;for(n+=this.data,t=this.nextSibling;t;)n+=t.data,t=t.nextSibling;return n}}),t}.call(this)}).call(this)},751:function(t,e,n){(function(){var e,r,i,s={}.hasOwnProperty;({assign:i}=n(369)),e=n(335),n(77),n(544),n(170),n(96),n(161),n(406),n(595),n(181),n(833),n(179),n(347),n(78),n(777),r=n(594),t.exports=class{constructor(t){var e,n,r;for(e in t||(t={}),this.options=t,n=t.writer||{})s.call(n,e)&&(r=n[e],this["_"+e]=this[e],this[e]=r)}filterOptions(t){var e,n,s,o,h,a,l,u,c;return t||(t={}),t=i({},this.options,t),(e={writer:this}).pretty=t.pretty||!1,e.allowEmpty=t.allowEmpty||!1,e.indent=null!=(n=t.indent)?n:"  ",e.newline=null!=(s=t.newline)?s:"\n",e.offset=null!=(o=t.offset)?o:0,e.width=null!=(h=t.width)?h:0,e.dontPrettyTextNodes=null!=(a=null!=(l=t.dontPrettyTextNodes)?l:t.dontprettytextnodes)?a:0,e.spaceBeforeSlash=null!=(u=null!=(c=t.spaceBeforeSlash)?c:t.spacebeforeslash)?u:"",!0===e.spaceBeforeSlash&&(e.spaceBeforeSlash=" "),e.suppressPrettyCount=0,e.user={},e.state=r.None,e}indent(t,e,n){var r;return!e.pretty||e.suppressPrettyCount?"":e.pretty&&(r=(n||0)+e.offset+1)>0?new Array(r).join(e.indent):""}endline(t,e,n){return!e.pretty||e.suppressPrettyCount?"":e.newline}attribute(t,e,n){var r;return this.openAttribute(t,e,n),r=e.pretty&&e.width>0?t.name+'="'+t.value+'"':" "+t.name+'="'+t.value+'"',this.closeAttribute(t,e,n),r}cdata(t,e,n){var i;return this.openNode(t,e,n),e.state=r.OpenTag,i=this.indent(t,e,n)+"<![CDATA[",e.state=r.InsideTag,i+=t.value,e.state=r.CloseTag,i+="]]>"+this.endline(t,e,n),e.state=r.None,this.closeNode(t,e,n),i}comment(t,e,n){var i;return this.openNode(t,e,n),e.state=r.OpenTag,i=this.indent(t,e,n)+"\x3c!-- ",e.state=r.InsideTag,i+=t.value,e.state=r.CloseTag,i+=" --\x3e"+this.endline(t,e,n),e.state=r.None,this.closeNode(t,e,n),i}declaration(t,e,n){var i;return this.openNode(t,e,n),e.state=r.OpenTag,i=this.indent(t,e,n)+"<?xml",e.state=r.InsideTag,i+=' version="'+t.version+'"',null!=t.encoding&&(i+=' encoding="'+t.encoding+'"'),null!=t.standalone&&(i+=' standalone="'+t.standalone+'"'),e.state=r.CloseTag,i+=e.spaceBeforeSlash+"?>",i+=this.endline(t,e,n),e.state=r.None,this.closeNode(t,e,n),i}docType(t,e,n){var i,s,o,h,a;if(n||(n=0),this.openNode(t,e,n),e.state=r.OpenTag,h=this.indent(t,e,n),h+="<!DOCTYPE "+t.root().name,t.pubID&&t.sysID?h+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(h+=' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(h+=" [",h+=this.endline(t,e,n),e.state=r.InsideTag,s=0,o=(a=t.children).length;s<o;s++)i=a[s],h+=this.writeChildNode(i,e,n+1);e.state=r.CloseTag,h+="]"}return e.state=r.CloseTag,h+=e.spaceBeforeSlash+">",h+=this.endline(t,e,n),e.state=r.None,this.closeNode(t,e,n),h}element(t,n,i){var o,h,a,l,u,c,d,p,m,f,g,y,w,b,D,v,O,I;if(i||(i=0),g=!1,this.openNode(t,n,i),n.state=r.OpenTag,y=this.indent(t,n,i)+"<"+t.name,n.pretty&&n.width>0)for(f in d=y.length,b=t.attribs)s.call(b,f)&&(o=b[f],d+(w=this.attribute(o,n,i)).length>n.width?(I=this.indent(t,n,i+1)+w,y+=this.endline(t,n,i)+I,d=I.length):(y+=I=" "+w,d+=I.length));else for(f in D=t.attribs)s.call(D,f)&&(o=D[f],y+=this.attribute(o,n,i));if(l=0===(a=t.children.length)?null:t.children[0],0===a||t.children.every((function(t){return(t.type===e.Text||t.type===e.Raw||t.type===e.CData)&&""===t.value})))n.allowEmpty?(y+=">",n.state=r.CloseTag,y+="</"+t.name+">"+this.endline(t,n,i)):(n.state=r.CloseTag,y+=n.spaceBeforeSlash+"/>"+this.endline(t,n,i));else if(!n.pretty||1!==a||l.type!==e.Text&&l.type!==e.Raw&&l.type!==e.CData||null==l.value){if(n.dontPrettyTextNodes)for(u=0,p=(v=t.children).length;u<p;u++)if(((h=v[u]).type===e.Text||h.type===e.Raw||h.type===e.CData)&&null!=h.value){n.suppressPrettyCount++,g=!0;break}for(y+=">"+this.endline(t,n,i),n.state=r.InsideTag,c=0,m=(O=t.children).length;c<m;c++)h=O[c],y+=this.writeChildNode(h,n,i+1);n.state=r.CloseTag,y+=this.indent(t,n,i)+"</"+t.name+">",g&&n.suppressPrettyCount--,y+=this.endline(t,n,i),n.state=r.None}else y+=">",n.state=r.InsideTag,n.suppressPrettyCount++,g=!0,y+=this.writeChildNode(l,n,i+1),n.suppressPrettyCount--,g=!1,n.state=r.CloseTag,y+="</"+t.name+">"+this.endline(t,n,i);return this.closeNode(t,n,i),y}writeChildNode(t,n,r){switch(t.type){case e.CData:return this.cdata(t,n,r);case e.Comment:return this.comment(t,n,r);case e.Element:return this.element(t,n,r);case e.Raw:return this.raw(t,n,r);case e.Text:return this.text(t,n,r);case e.ProcessingInstruction:return this.processingInstruction(t,n,r);case e.Dummy:return"";case e.Declaration:return this.declaration(t,n,r);case e.DocType:return this.docType(t,n,r);case e.AttributeDeclaration:return this.dtdAttList(t,n,r);case e.ElementDeclaration:return this.dtdElement(t,n,r);case e.EntityDeclaration:return this.dtdEntity(t,n,r);case e.NotationDeclaration:return this.dtdNotation(t,n,r);default:throw new Error("Unknown XML node type: "+t.constructor.name)}}processingInstruction(t,e,n){var i;return this.openNode(t,e,n),e.state=r.OpenTag,i=this.indent(t,e,n)+"<?",e.state=r.InsideTag,i+=t.target,t.value&&(i+=" "+t.value),e.state=r.CloseTag,i+=e.spaceBeforeSlash+"?>",i+=this.endline(t,e,n),e.state=r.None,this.closeNode(t,e,n),i}raw(t,e,n){var i;return this.openNode(t,e,n),e.state=r.OpenTag,i=this.indent(t,e,n),e.state=r.InsideTag,i+=t.value,e.state=r.CloseTag,i+=this.endline(t,e,n),e.state=r.None,this.closeNode(t,e,n),i}text(t,e,n){var i;return this.openNode(t,e,n),e.state=r.OpenTag,i=this.indent(t,e,n),e.state=r.InsideTag,i+=t.value,e.state=r.CloseTag,i+=this.endline(t,e,n),e.state=r.None,this.closeNode(t,e,n),i}dtdAttList(t,e,n){var i;return this.openNode(t,e,n),e.state=r.OpenTag,i=this.indent(t,e,n)+"<!ATTLIST",e.state=r.InsideTag,i+=" "+t.elementName+" "+t.attributeName+" "+t.attributeType,"#DEFAULT"!==t.defaultValueType&&(i+=" "+t.defaultValueType),t.defaultValue&&(i+=' "'+t.defaultValue+'"'),e.state=r.CloseTag,i+=e.spaceBeforeSlash+">"+this.endline(t,e,n),e.state=r.None,this.closeNode(t,e,n),i}dtdElement(t,e,n){var i;return this.openNode(t,e,n),e.state=r.OpenTag,i=this.indent(t,e,n)+"<!ELEMENT",e.state=r.InsideTag,i+=" "+t.name+" "+t.value,e.state=r.CloseTag,i+=e.spaceBeforeSlash+">"+this.endline(t,e,n),e.state=r.None,this.closeNode(t,e,n),i}dtdEntity(t,e,n){var i;return this.openNode(t,e,n),e.state=r.OpenTag,i=this.indent(t,e,n)+"<!ENTITY",e.state=r.InsideTag,t.pe&&(i+=" %"),i+=" "+t.name,t.value?i+=' "'+t.value+'"':(t.pubID&&t.sysID?i+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(i+=' SYSTEM "'+t.sysID+'"'),t.nData&&(i+=" NDATA "+t.nData)),e.state=r.CloseTag,i+=e.spaceBeforeSlash+">"+this.endline(t,e,n),e.state=r.None,this.closeNode(t,e,n),i}dtdNotation(t,e,n){var i;return this.openNode(t,e,n),e.state=r.OpenTag,i=this.indent(t,e,n)+"<!NOTATION",e.state=r.InsideTag,i+=" "+t.name,t.pubID&&t.sysID?i+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.pubID?i+=' PUBLIC "'+t.pubID+'"':t.sysID&&(i+=' SYSTEM "'+t.sysID+'"'),e.state=r.CloseTag,i+=e.spaceBeforeSlash+">"+this.endline(t,e,n),e.state=r.None,this.closeNode(t,e,n),i}openNode(t,e,n){}closeNode(t,e,n){}openAttribute(t,e,n){}closeAttribute(t,e,n){}}}).call(this)},532:function(t,e,n){(function(){var e,r,i,s,o,h,a,l,u;({assign:l,isFunction:u}=n(369)),i=n(770),s=n(934),o=n(227),a=n(434),h=n(996),e=n(335),r=n(594),t.exports.create=function(t,e,n,r){var i,o;if(null==t)throw new Error("Root element needs a name.");return r=l({},e,n,r),o=(i=new s(r)).element(t),r.headless||(i.declaration(r),null==r.pubID&&null==r.sysID||i.dtd(r)),o},t.exports.begin=function(t,e,n){return u(t)&&([e,n]=[t,e],t={}),e?new o(t,e,n):new s(t)},t.exports.stringWriter=function(t){return new a(t)},t.exports.streamWriter=function(t,e){return new h(t,e)},t.exports.implementation=new i,t.exports.nodeType=e,t.exports.writerState=r}).call(this)}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var s=e[r]={exports:{}};return t[r].call(s.exports,s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t=n(532),e=n.n(t);function r(t){console.log("aici");const e=document.getElementById(t),n=Chart.getChart(e);if(n){const e="data:text/csv;charset=utf-8,"+function(t,e){let n="";n+=["Label",...e.map((t=>t.label))].join(",")+"\n";for(let r=0;r<t.length;r++)n+=[t[r],...e.map((t=>t.data[r]))].join(",")+"\n";return n}(n.data.labels||[],n.data.datasets||[]),r=document.createElement("a");r.href=encodeURI(e),r.download=`${t}.csv`,r.click()}}function i(t){const n=document.getElementById(t),r=Chart.getChart(n);if(r){const n=function(t,n){const r=e().create("book",{version:"1.0",encoding:"UTF-8"}),i=r.ele("chapter");i.ele("title","Most Rated Books");const s=i.ele("table").ele("tgroup",{cols:n.length+1}),o=s.ele("thead"),h=s.ele("tbody"),a=o.ele("row");a.ele("entry","Label"),n.forEach((t=>{a.ele("entry",t.label)}));for(let e=0;e<t.length;e++){const r=h.ele("row");r.ele("entry",t[e]),n.forEach((t=>{r.ele("entry",t.data[e])}))}return r.end({pretty:!0})}(r.data.labels||[],r.data.datasets||[]),i=document.createElement("a");i.href="data:text/xml;charset=utf-8,"+encodeURIComponent(n),i.download=`${t}.xml`,i.click()}}document.addEventListener("DOMContentLoaded",(function(){const t=document.getElementById("most-rated-csv"),e=document.getElementById("highest-rated-csv"),n=document.getElementById("most-user-reviews-csv"),s=document.getElementById("most-rated-doc"),o=document.getElementById("highest-rated-doc"),h=document.getElementById("most-user-reviews-doc");t.addEventListener("click",(function(){r("mostRatedBooks")})),s.addEventListener("click",(function(){i("mostRatedBooks")})),e.addEventListener("click",(function(){r("highestRatedBooks")})),o.addEventListener("click",(function(){i("highestRatedBooks")})),n.addEventListener("click",(function(){r("usersMostReviews")})),h.addEventListener("click",(function(){i("usersMostReviews")}))}))})()})();